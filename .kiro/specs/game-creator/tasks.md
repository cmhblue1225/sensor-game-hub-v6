# 구현 계획 - CSS 3D 레이싱 게임

## 개요

CSS 3D transforms를 사용한 자동차 경주 게임을 센서 게임 허브에 추가하기 위한 단계별 구현 계획입니다. Three.js 대신 순수 CSS와 JavaScript를 사용하여 3D 효과를 구현하며, 안정성과 성능을 최우선으로 합니다.

## 작업 목록

- [x] 1. 프로젝트 구조 및 기본 파일 생성
  - 기존 racing-3d 폴더 정리 및 새로운 구조 생성
  - GAME_TEMPLATE.html을 기반으로 한 새로운 index.html 생성
  - CSS 3D transforms 기반 스타일 시스템 구현
  - 표준 game.json 메타데이터 파일 업데이트
  - _요구사항: 5.1, 5.2_

- [ ] 2. SessionSDK 통합 및 기본 게임 초기화
  - SessionSDK를 사용한 듀얼 게임 세션 생성
  - `event.detail || event` 패턴으로 이벤트 처리 구현
  - 서버 연결 완료 후 세션 생성 로직 구현
  - QR 코드 생성 및 폴백 처리 구현 (올바른 URL 사용)
  - _요구사항: 5.3, 5.4_

- [ ] 3. CSS 3D 게임 환경 구축
  - CSS perspective와 transform-style: preserve-3d 설정
  - 3D 트랙 레이아웃 구현 (CSS transforms 사용)
  - 화면 분할 시스템 구현 (좌우 또는 상하)
  - 3D 원근감과 깊이감 구현
  - _요구사항: 3.1, 2.1_

- [ ] 4. CSS 기반 자동차 모델 생성
  - HTML/CSS로 3D 자동차 모델 구현
  - 자동차 바디, 바퀴, 헤드라이트 등 세부 요소 생성
  - CSS animations를 사용한 바퀴 회전 효과
  - 플레이어별 자동차 색상 및 스타일 차별화
  - _요구사항: 1.1, 2.2, 2.3_

- [ ] 5. 센서 데이터 처리 및 자동차 조작 구현
  - 센서 데이터 수신 및 파싱 구현
  - 기울기 데이터를 CSS transform으로 변환하는 로직 구현
  - 좌우 기울기 → rotateY (핸들 조작)
  - 앞뒤 기울기 → translateZ (가속/브레이크)
  - 센서별 독립적인 자동차 제어 구현
  - _요구사항: 1.1, 1.2, 1.3, 1.4_

- [ ] 6. 3D 트랙 및 환경 요소 구현
  - CSS로 3D 트랙 레이아웃 생성
  - 트랙 경계선 및 가드레일 구현
  - 시작선과 결승선 표시
  - 체크포인트 시각적 표시 구현
  - 배경 환경 요소 (하늘, 산, 건물 등) 추가
  - _요구사항: 3.1, 4.1_

- [ ] 7. 게임 로직 및 물리 시뮬레이션 구현
  - 간단한 JavaScript 기반 물리 시뮬레이션
  - 자동차 위치, 속도, 가속도 계산
  - 트랙 경계 충돌 감지 및 처리
  - 자동차 간 충돌 감지 (거리 기반)
  - 마찰력 및 관성 시뮬레이션
  - _요구사항: 3.2, 3.3, 3.4_

- [ ] 8. 게임 상태 관리 시스템 구현
  - 게임 상태 (waiting, racing, finished) 관리
  - 플레이어별 상태 추적 (위치, 속도, 랩 수)
  - 게임 시작 카운트다운 구현
  - 게임 일시정지 및 재개 기능
  - _요구사항: 4.4, 6.2_

- [ ] 9. 랩 카운트 및 순위 시스템 구현
  - 체크포인트 통과 감지 로직 (위치 기반)
  - 랩 완주 판정 및 카운트 증가
  - 랩 타임 측정 및 기록
  - 실시간 순위 계산 및 표시
  - _요구사항: 4.1, 4.2_

- [ ] 10. UI 및 HUD 시스템 구현
  - 플레이어별 HUD (속도, 랩 수, 시간) 구현
  - 게임 컨트롤 패널 (재시작, 일시정지, 허브로) 구현
  - 연결 상태 표시 UI
  - 게임 상태 메시지 표시
  - _요구사항: 2.4, 4.4_

- [ ] 11. 게임 종료 및 결과 표시 구현
  - 경주 완료 조건 확인 (3랩 완주)
  - 승자 결정 로직
  - 최종 결과 화면 구현
  - 최고 기록 및 통계 표시 (localStorage 사용)
  - _요구사항: 4.2, 4.3_

- [ ] 12. 센서 연결 오류 처리 구현
  - 센서 연결 끊김 감지 및 게임 일시정지
  - 재연결 대기 메시지 표시
  - 센서 재연결 시 게임 재개
  - 연결 상태 UI 업데이트
  - _요구사항: 6.3_

- [ ] 13. 재시작 및 세션 관리 기능 구현
  - 재시작 버튼 클릭 시 게임 상태만 초기화
  - 센서 연결 및 세션 유지
  - 게임 종료 시 허브로 돌아가기 기능
  - 세션 정리 및 메모리 해제
  - _요구사항: 6.1, 6.4_

- [ ] 14. 키보드 테스트 기능 구현
  - 개발 및 테스트를 위한 키보드 조작 구현
  - 플레이어 1: WASD 키로 조작
  - 플레이어 2: 화살표 키로 조작
  - 키보드/센서 모드 전환 기능
  - _요구사항: 1.1, 1.2, 1.3_

- [ ] 15. 성능 최적화 및 애니메이션 개선
  - CSS transitions와 animations 최적화
  - 60fps 유지를 위한 렌더링 최적화
  - 센서 데이터 throttling (33ms 간격)
  - 메모리 사용량 최적화
  - _요구사항: 1.4, 2.1_

- [ ] 16. 게임 테스트 및 버그 수정
  - 센서 연결 및 데이터 전송 테스트
  - CSS 3D 효과 크로스 브라우저 테스트
  - 게임 플로우 전체 테스트
  - 모바일 기기 호환성 테스트
  - _요구사항: 모든 요구사항_

- [ ] 17. 게임 허브 통합 및 배포 준비
  - 게임 폴더를 public/games/에 배치
  - 서버 재시작 또는 /api/admin/rescan으로 게임 등록 확인
  - 허브 메인 페이지에서 게임 표시 확인
  - 최종 사용자 테스트 및 피드백 반영
  - _요구사항: 5.1, 5.4_