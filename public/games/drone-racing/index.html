<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🚁 3D 드론 레이싱</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    
    <div class="game-ui">
        <!-- 세션 대기 패널 -->
        <div class="ui-panel session-panel" id="sessionPanel">
            <div class="session-title">🚁 3D 드론 레이싱</div>
            <div class="session-subtitle">
                미래적인 네온 도시에서 펼쳐지는 드론 경주!<br>
                센서로 드론을 조작하며 화려한 부스터와 함께 경쟁하세요!
            </div>
            
            <div class="session-code" id="sessionCode">----</div>
            
            <div class="qr-container" id="qrContainer">
                <div class="qr-loading">QR 코드 생성 중...</div>
            </div>
            
            <div class="session-instructions">
                📱 모바일로 QR 코드를 스캔하거나<br>
                센서 클라이언트에서 세션 코드를 입력하세요
            </div>
        </div>
        
        <!-- 게임 HUD -->
        <div class="game-hud hidden" id="gameHUD">
            <!-- 플레이어 1 HUD (왼쪽) -->
            <div class="player-hud player1-hud" id="player1HUD">
                <div class="hud-panel">
                    <div class="player-name">플레이어 1</div>
                    <div class="speed">속도: 0 km/h</div>
                    <div class="lap">랩: 0/3</div>
                    <div class="time">시간: 0.00s</div>
                    <div class="rank">순위: 1</div>
                    <div class="booster">
                        <div class="booster-label">부스터</div>
                        <div class="booster-bar">
                            <div class="booster-fill" style="width: 100%"></div>
                        </div>
                        <span class="booster-percent">100%</span>
                        <div class="booster-status"></div>
                    </div>
                </div>
            </div>
            
            <!-- 플레이어 2 HUD (오른쪽) -->
            <div class="player-hud player2-hud" id="player2HUD">
                <div class="hud-panel">
                    <div class="player-name">플레이어 2</div>
                    <div class="speed">속도: 0 km/h</div>
                    <div class="lap">랩: 0/3</div>
                    <div class="time">시간: 0.00s</div>
                    <div class="rank">순위: 2</div>
                    <div class="booster">
                        <div class="booster-label">부스터</div>
                        <div class="booster-bar">
                            <div class="booster-fill" style="width: 100%"></div>
                        </div>
                        <span class="booster-percent">100%</span>
                        <div class="booster-status"></div>
                    </div>
                </div>
            </div>
            
            <!-- 카운트다운 -->
            <div class="countdown hidden" id="countdown">3</div>
        </div>
        
        <!-- 컨트롤 패널 -->
        <div class="ui-panel control-panel hidden" id="controlPanel">
            <button class="btn btn-secondary" onclick="game.restartGame()">🔄 재시작</button>
            <button class="btn btn-secondary" onclick="game.togglePause()">⏸️ 일시정지</button>
            <a href="/" class="btn btn-secondary">🏠 허브로</a>
        </div>
        
        <!-- 결과 패널 -->
        <div class="ui-panel results-panel hidden" id="resultsPanel">
            <div class="results-title">🏆 경주 결과</div>
            <div class="results-content" id="resultsContent">
                <!-- 결과 내용이 여기에 표시됩니다 -->
            </div>
            <div class="results-actions">
                <button class="btn btn-primary" onclick="game.restartGame()">🔄 다시 경주</button>
                <a href="/" class="btn btn-secondary">🏠 허브로</a>
            </div>
        </div>
        
        <!-- 재연결 메시지 -->
        <div class="ui-panel reconnect-panel hidden" id="reconnectPanel">
            <div class="reconnect-title">📱 센서 재연결 대기</div>
            <div class="reconnect-message" id="reconnectMessage">
                센서 연결이 끊어졌습니다. 재연결을 기다리는 중...
            </div>
        </div>
        
        <!-- 성능 모니터링 패널 (개발자 모드) -->
        <div class="performance-panel hidden" id="performancePanel">
            <div class="performance-title">🚀 성능 모니터</div>
            <div class="performance-stats" id="performanceStats">
                <div class="stat-item">
                    <span class="stat-label">FPS:</span>
                    <span class="stat-value" id="fpsValue">60</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">프레임 시간:</span>
                    <span class="stat-value" id="frameTimeValue">16.67ms</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">메모리:</span>
                    <span class="stat-value" id="memoryValue">0MB</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">파티클:</span>
                    <span class="stat-value" id="particleValue">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">품질:</span>
                    <span class="stat-value" id="qualityValue">HIGH</span>
                </div>
            </div>
            <div class="performance-controls">
                <button class="btn btn-small" onclick="game.performanceOptimizer?.setQuality('low')">LOW</button>
                <button class="btn btn-small" onclick="game.performanceOptimizer?.setQuality('medium')">MED</button>
                <button class="btn btn-small" onclick="game.performanceOptimizer?.setQuality('high')">HIGH</button>
            </div>
        </div>
    </div>
    
    <!-- 라이브러리 로드 -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://unpkg.com/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="/js/SessionSDK.js"></script>
    <script src="libs/three.min.js"></script>
    <script src="libs/cannon.min.js"></script>
    
    <!-- 게임 스크립트 -->
    <script src="js/drone.js"></script>
    <script src="js/track.js"></script>
    <script src="js/effects.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/physics.js"></script>
    <script src="js/gameState.js"></script>
    <script src="js/performance.js"></script>
    <script src="js/bugfixes.js"></script>
    <script src="js/game.js"></script>
</body>
</html>