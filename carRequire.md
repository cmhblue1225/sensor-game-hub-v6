# 요구사항 문서

## 개요

3D 레이싱 게임은 Sensor Game Hub v6.0 플랫폼에서 실행되는 2인 경쟁 모바일 센서 기반 레이싱 게임입니다. 두 명의 플레이어가 각자의 모바일 기기 기울기 센서를 사용하여 3D 환경에서 자동차를 조종하며, 화면이 좌우로 분할되어 각 플레이어가 자신의 화면을 보면서 동시에 경쟁합니다. 게임은 원근법을 활용한 3D 시각 효과와 물리 기반 자동차 조작을 제공하여 몰입감 있는 실시간 경쟁 레이싱 경험을 선사합니다.

## 요구사항

### 요구사항 1

**사용자 스토리:** 두 명의 플레이어로서, 각자의 모바일 기기 기울기 센서를 사용하여 분할된 화면에서 동시에 3D 레이싱 카를 조종하고 싶다. 그래야 실시간으로 경쟁할 수 있다.

#### 수락 기준

1. WHEN 플레이어 1이 모바일 기기를 왼쪽으로 기울이면 THEN 좌측 화면의 자동차는 기울기에 비례하여 왼쪽으로 조향해야 한다
2. WHEN 플레이어 2가 모바일 기기를 오른쪽으로 기울이면 THEN 우측 화면의 자동차는 기울기에 비례하여 오른쪽으로 조향해야 한다
3. WHEN 각 플레이어가 모바일 기기를 앞으로 기울이면 THEN 해당 플레이어의 자동차는 가속해야 한다
4. WHEN 각 플레이어가 모바일 기기를 뒤로 기울이면 THEN 해당 플레이어의 자동차는 브레이크를 걸거나 후진해야 한다
5. IF 기울기 각도가 최대 임계값을 초과하면 THEN 조향 반응은 최대 회전율로 제한되어야 한다
6. WHEN 두 센서가 모두 연결되면 THEN 시스템은 게임 시작 준비 상태를 표시해야 한다

### 요구사항 2

**사용자 스토리:** 두 명의 플레이어로서, 화면이 좌우로 분할되어 각자의 3D 레이싱 트랙을 독립적으로 보고 싶다. 그래야 각자 자신의 경주에 집중할 수 있다.

#### 수락 기준

1. WHEN 게임이 시작되면 THEN 시스템은 화면을 정확히 좌우 50:50으로 분할해야 한다
2. WHEN 좌측 화면을 렌더링할 때 THEN 시스템은 플레이어 1의 자동차 시점에서 3D 트랙을 표시해야 한다
3. WHEN 우측 화면을 렌더링할 때 THEN 시스템은 플레이어 2의 자동차 시점에서 3D 트랙을 표시해야 한다
4. WHEN 각 자동차가 앞으로 이동하면 THEN 해당 화면의 트랙은 적절한 깊이 인식과 함께 스크롤되어야 한다
5. IF 한 플레이어의 자동차가 트랙을 벗어나면 THEN 해당 화면에만 오프로드 시각적 피드백을 표시해야 한다
6. WHEN 분할 화면을 렌더링할 때 THEN 시스템은 각 화면에서 30fps 이상의 성능을 유지해야 한다

### 요구사항 3

**사용자 스토리:** 두 명의 플레이어로서, 실시간으로 서로의 경주 진행 상황과 순위를 비교하고 싶다. 그래야 경쟁의 재미를 느낄 수 있다.

#### 수락 기준

1. WHEN 각 플레이어가 랩을 완주하면 THEN 시스템은 두 플레이어의 랩 타임을 동시에 비교 표시해야 한다
2. WHEN 한 플레이어가 다른 플레이어보다 앞서면 THEN 시스템은 현재 순위를 실시간으로 표시해야 한다
3. WHEN 레이스가 끝나면 THEN 시스템은 승자를 명확히 표시하고 두 플레이어의 최종 기록을 비교해야 한다
4. WHEN 게임 중에 THEN 시스템은 각 화면 상단에 현재 랩 타임과 상대방과의 시간 차이를 표시해야 한다
5. IF 두 플레이어의 기록이 매우 근접하면 THEN 시스템은 밀리초 단위까지 정확히 측정해야 한다
6. WHEN 새로운 게임을 시작할 때 THEN 시스템은 이전 게임의 승부 기록을 표시해야 한다

### 요구사항 4

**사용자 스토리:** 두 명의 플레이어로서, 각자 독립적인 물리 시뮬레이션과 충돌 감지를 경험하고 싶다. 그래야 공정한 경쟁이 가능하다.

#### 수락 기준

1. WHEN 플레이어 1의 자동차가 가속하면 THEN 시스템은 플레이어 1에게만 적용되는 독립적인 물리 계산을 수행해야 한다
2. WHEN 플레이어 2의 자동차가 충돌하면 THEN 시스템은 플레이어 2에게만 충돌 페널티를 적용해야 한다
3. WHEN 각 플레이어의 자동차가 코너를 돌 때 THEN 시스템은 각각 독립적인 원심력 효과를 계산해야 한다
4. WHEN 한 플레이어가 트랙을 벗어나면 THEN 시스템은 해당 플레이어에게만 속도 감소 페널티를 적용해야 한다
5. IF 두 플레이어가 동일한 조건에서 플레이하면 THEN 시스템은 동일한 물리 법칙을 적용해야 한다
6. WHEN 물리 시뮬레이션을 계산할 때 THEN 시스템은 두 플레이어 간 간섭 없이 독립적으로 처리해야 한다

### 요구사항 5

**사용자 스토리:** 두 명의 플레이어로서, 각자의 화면에서 개별적인 시각적 및 청각적 피드백을 받고 싶다. 그래야 자신의 상황에 집중할 수 있다.

#### 수락 기준

1. WHEN 플레이어 1의 자동차 엔진이 회전하면 THEN 시스템은 좌측 스피커에서 해당 엔진음을 출력해야 한다
2. WHEN 플레이어 2가 충돌하면 THEN 시스템은 우측 스피커에서 충돌음을 출력해야 한다
3. WHEN 각 플레이어가 좋은 기록을 달성하면 THEN 시스템은 해당 플레이어의 화면에만 축하 효과를 표시해야 한다
4. WHEN 플레이어가 드리프트하면 THEN 시스템은 해당 플레이어의 화면에만 타이어 연기 효과를 표시해야 한다
5. IF 한 플레이어가 트랙을 벗어날 위험이 있으면 THEN 시스템은 해당 화면에만 경고를 표시해야 한다
6. WHEN 한 플레이어가 결승선을 통과하면 THEN 시스템은 승리 사운드와 함께 전체 화면에 승자를 표시해야 한다

### 요구사항 6

**사용자 스토리:** 게임 관리자로서, 2인 경쟁 게임이 Sensor Game Hub v6.0 플랫폼의 dual 게임 타입으로 원활하게 통합되기를 원한다. 그래야 플레이어들이 쉽게 접근할 수 있다.

#### 수락 기준

1. WHEN 게임이 초기화되면 THEN 시스템은 SessionSDK를 `gameType: 'dual'`로 설정하여 세션을 생성해야 한다
2. WHEN 첫 번째 모바일 센서가 연결되면 THEN 시스템은 이를 sensor1로 식별하고 플레이어 1에 할당해야 한다
3. WHEN 두 번째 모바일 센서가 연결되면 THEN 시스템은 이를 sensor2로 식별하고 플레이어 2에 할당해야 한다
4. WHEN 센서 데이터가 수신되면 THEN 시스템은 `event.detail || event` 패턴과 `sensorId`를 사용하여 올바른 플레이어에게 할당해야 한다
5. IF 한 센서의 연결이 끊어지면 THEN 시스템은 게임을 일시정지하고 재연결을 기다려야 한다
6. WHEN 두 센서가 모두 연결되면 THEN 시스템은 게임 시작 버튼을 활성화해야 한다
7. WHEN 게임 내에서 재시작 버튼을 누르면 THEN 시스템은 기존 세션과 센서 연결을 유지한 채로 새 게임을 시작해야 한다
8. WHEN 여러 번 게임을 재시작해도 THEN 시스템은 플레이어들이 다시 QR 코드를 스캔할 필요 없이 연결을 유지해야 한다

### 요구사항 7

**사용자 스토리:** 두 명의 플레이어로서, 다양한 경쟁 모드와 트랙에서 플레이하고 싶다. 그래야 지루하지 않고 계속 도전할 수 있다.

#### 수락 기준

1. WHEN 게임 모드를 선택할 때 THEN 시스템은 "빠른 경주", "베스트 오브 3", "타임 어택" 모드를 제공해야 한다
2. WHEN "빠른 경주" 모드를 선택하면 THEN 시스템은 3랩 경주로 승부를 결정해야 한다
3. WHEN "베스트 오브 3" 모드를 선택하면 THEN 시스템은 3번의 경주 중 2승을 먼저 하는 플레이어를 최종 승자로 해야 한다
4. WHEN "타임 어택" 모드를 선택하면 THEN 시스템은 제한 시간 내 가장 많은 랩을 완주한 플레이어를 승자로 해야 한다
5. IF 트랙을 선택할 때 THEN 시스템은 최소 3개의 서로 다른 난이도의 트랙을 제공해야 한다
6. WHEN 경주가 끝날 때마다 THEN 시스템은 다음 경주를 위한 트랙 선택 옵션을 제공해야 한다

### 요구사항 8

**사용자 스토리:** 개발자 및 테스터로서, 완성된 3D 레이싱 게임을 Sensor Game Hub v6.0 시스템에 통합하여 테스트하고 배포하고 싶다. 그래야 실제 환경에서 게임을 검증할 수 있다.

#### 수락 기준

1. WHEN 게임 개발이 완료되면 THEN 시스템은 `sensor-game-hub-v6/public/games/3d-racing-game/` 디렉터리에 배치될 수 있어야 한다
2. WHEN 게임을 허브 시스템에 배치할 때 THEN 시스템은 기존 허브의 게임 스캐닝 시스템과 호환되어야 한다
3. WHEN 허브에서 게임을 선택할 때 THEN 시스템은 3D 레이싱 게임을 dual 게임 타입으로 올바르게 인식해야 한다
4. WHEN 허브 환경에서 게임을 실행할 때 THEN 시스템은 SessionSDK와 센서 연결이 정상적으로 작동해야 한다
5. IF 게임 파일 구조가 허브 시스템과 호환되지 않으면 THEN 시스템은 명확한 오류 메시지를 표시해야 한다
6. WHEN 게임 메타데이터를 설정할 때 THEN 시스템은 `game.json` 파일에 올바른 게임 정보를 포함해야 한다
7. WHEN 여러 게임이 허브에 등록되어 있을 때 THEN 시스템은 3D 레이싱 게임을 다른 게임들과 구별하여 표시해야 한다